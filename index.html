<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrainQuest</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: Arial, sans-serif;
            overflow: hidden;
            background: url(Assets/background.gif) no-repeat center center/cover;
        }
        #story {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: url(Assets/background.gif) no-repeat center center/cover;
        }
       /* Camera Overlay Section */
    #camera-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      background-color: white;
      display: none;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      gap: 20px;
      z-index: 999;
    }

    #camera {
      width: 300px;
      height: 300px;
      border-radius: 50%;
      object-fit: cover;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
    }
    #captured-image-wrapper {
  position: absolute;
  bottom: 60px;
  left: 10px;
  width: 80px; /* Size of the circle */
  height: 80px;
  border: 3px solid white;
  border-radius: 50%; /* Makes it a circle */
  overflow: hidden; /* Hide outside parts */
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  z-index: 500;
  background: white; /* Optional background for contrast */
}

#captured-image {
  width: 100%;
  height: 100%;
  object-fit: cover; /* Crop to fill the circle */
  object-position: center top; /* Focus on upper part, like face */
}



/* Map section */
#map {
      position: absolute;
      top: 0;
      left: 0;
      width: 1152px; /* Map image width */
      height: 648px; /* Map image height */
      background: url(Assets/map.gif) no-repeat center center;
      background-size: cover;
      transition: transform 0.1s ease-out;
    }

/* Map takes full space */
    .map-container {
      width: 100%;
      height: 100%;
      position: relative;
      cursor: grab;
      overflow: hidden;
    }


/* Houses */
.house {
    width: auto;
    height: auto;
    background: #ffffff00;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    position: absolute;
    transition: transform 0.2s;
}

.house:hover {
    transform: scale(1.1);
}

.locked {
    background: gray;
    cursor: not-allowed;
}

/* House positions */
#house1 { bottom: 23%; left: 3%; }
#easyhouse1 { bottom: 22%; left: 11.5%; }
#easyhouse2 { bottom: 22%; left: 22.5%; }
#easyhouse3 { bottom: 15%; left: 32%; }
#easyhouse4 { bottom: 5%; left: 42.5%; }
#easyhouse5 { bottom: 3%; left: 57%; }
#house2 { bottom: 3%; right: 24%; }
#ehouse1 { bottom: 3%; right: 12%; }
#ehouse2 { bottom: 18%; right: 3%; }
#ehouse3 { bottom: 35%; right: 3%; }
#ehouse4 { bottom: 40%; right: 16%; }
#ehouse5 { bottom: 35%; right: 27%; }
#house3 { bottom: 32%; right: 37%; }
#medhouse1 { bottom: 35%; right: 46%; }
#medhouse2 { bottom: 40%; left: 39%; }
#medhouse3 { bottom: 37%; left: 27.5%; }
#medhouse4 { bottom: 40%; left: 17.5%; }
#medhouse5 { bottom: 42%; left: 7%; }
#house4 { top: 30%; left: 2%; }
#mediumhouse1 { top: 14%; left: 8.5%; }
#mediumhouse2 { top: 8%; left: 17%; }
#mediumhouse3 { top: 7%; left: 25%; }
#mediumhouse4 { top: 15%; left: 31.5%; }
#mediumhouse5 { top: 23%; left: 38%; }
#house5 { top: 30%; left: 2%; }
#hardhouse1 { top: 5%; left: 50%; }
#hardhouse2 { top: 8%; right: 17%; }
#hardhouse3 { top: 7%; right: 25%; }
#hardhouse4 { top: 15%; right: 31.5%; }
#hardhouse5 { top: 23%; right: 38%; }


/* Leaderboard styling */
#leaderboard {
      width: 170px;
      height: 100vh;
      position: fixed;
      right: 0;
      top: 0;
      background: rgba(255, 173, 173, 0.95);
      border-left: 2px solid #ccc;
      padding: 20px;
      overflow-y: auto;
      z-index: 15;
}

#leaderboard h2 {
    margin-bottom: 10px;
    color: #c2185b;
}

#leaderboard ol {
    list-style: decimal inside;
    padding: 0;
}

#leaderboard li {
    padding: 8px;
    margin-bottom: 8px;
    background: white;
    border-radius: 4px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

/* Responsive Adjustments */
@media (max-width: 768px) {
    #map {
        width: 100vw;
    }
    #leaderboard {
        display: none; /* Hide leaderboard on small screens */
    }
}

@media (max-width: 480px) {
    .map-container {
        width: 100vw;
        height: 70vh;
        background-size: cover;
    }
}
    button {
      padding: 10px 20px;
      font-size: 14px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
    }

    button:hover {
      background-color: #0056b3;
    }
                .start-btn {
                    position: absolute;
                    bottom: 15%;
                    right: 5%;
                    background-color: #fc5658;
                    color: white;
                    border: solid 2px black;
                    padding: 10px 20px;
                    font-size: 18px;
                    border-radius: 20px;
                    cursor: pointer;
                    transition: 0.3s;
                }
        
                .start-btn:hover {
                    background-color: darkred;
                }
        input {
            position: absolute;
            padding: 10px;
            font-size: 18px;
            height: 30px;
            border-radius: 20px;
            border: solid 2px black;
            text-align: center;
            outline: none;
            background-color: #efdbb9;
            top: 50%;
            left: 41%;
        }
        .face {
            position: absolute;
            bottom: 10%;
            left: 47%;
            display: block;
            margin: 20px auto;
            width: 100px;
            cursor: pointer;
            border-radius: 50px;
        }
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        @font-face {
            font-family: 'Boorsok';
            src: url(Font/boorsok.otf);
        }
        .welcome-message {
            position: absolute;
            top: 20%;
            left: 50%;
            transform: translate(-50%, -50%);
            align-items: center;
            text-align: center;
            font-size: 150px;
            font-weight: bold;
            line-height: 0.8;
            letter-spacing: 2px;
            font-family: 'Boorsok', sans-serif;
            color: #ffdede;
            text-shadow: 4px 4px 6px rgba(0, 0, 0, 0.3), 0 0 15px #ff69b4, 0 0 30px #ff1493;
            animation: blink 1.5s infinite alternate;
            white-space: nowrap;
        }

        .mechanics {
    position: absolute;
    top: 55%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 18px;
    line-height: 1.8;
    color: #333;
    background: rgba(255, 255, 255, 0.3); /* Soft white with transparency */
    padding: 30px 40px;
    border-radius: 20px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    width: 600px; /* Fixed width */
    max-width: 90%; /* Responsive for small screens */
    backdrop-filter: blur(10px); /* Frosted glass effect */
    text-align: center;
}



.mechanics p {
    margin: 12px 0;
    font-weight: 500;
    color: #333;
}

.mechanics button {
    padding: 12px 35px;
    margin-top: 20px;
    background: linear-gradient(135deg, #ff416c, #ff4b2b);
    color: white;
    border: none;
    border-radius: 50px;
    font-size: 1.2rem;
    cursor: pointer;
    transition: 0.3s ease;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

.mechanics button:hover {
    background: linear-gradient(135deg, #ff4b2b, #ff416c);
    transform: scale(1.05);
}

/* Optional: Media query for smaller screens */
@media (max-width: 600px) {
    .mechanics {
        width: 90%; /* Adjust width on small screens */
        padding: 20px;
    }

    .mechanics h1 {
        font-size: 2rem;
    }
}



            .story-container {
            position: absolute;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%); /* Centers it */
            max-width: 800px;
            width: 90%;
            padding: 20px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            text-align: center;
        }

            .story-container h2 {
                font-size: 24px;
                color: #333;
            }

            .story-container p {
                font-size: 18px;
                color: #555;
                line-height: 1.6;
            }

            .story-container button {
                background-color: #ff6f61;
                color: white;
                border: none;
                padding: 10px 20px;
                font-size: 16px;
                cursor: pointer;
                border-radius: 5px;
                margin-top: 20px;
            }

            .story-container button:hover {
                background-color: #e65c50;
            }
            #question-content {
            display: none; /* Initially hidden */
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 10px;
        }

        /* Media Queries for responsiveness */
        @media (max-width: 768px) {
            .map-container {
                width: 90%;
                height: auto;
            }

            .house {
                width: 40px;
                height: 40px;
                line-height: 40px;
                margin: 5px;
            }

            .start-btn {
                bottom: 10%;
                right: 5%;
                padding: 8px 16px;
                font-size: 16px;
            }
            .welcome-message {
                font-size: 70px;
            }
        
            input {
                width: 80%;
                left: 10%;
                top: 40%;
            }

            .face {
                bottom: 5%;
                left: 40%;
                width: 80px;
            }
        }

        @media (max-width: 480px) {
            .house {
                width: 30px;
                height: 30px;
                line-height: 30px;
                margin: 3px;
            }

            .start-btn {
                bottom: 5%;
                right: 5%;
                padding: 6px 12px;
                font-size: 14px;
            }
            .welcome-message {
                font-size: 90px;
            }
            input {
                width: 90%;
                left: 5%;
                top: 35%;
            }

            .face {
                bottom: 5%;
                left: 35%;
                width: 60px;
            }
        }
        /* By default, hide all containers */
        .container {
            display: none;
            position: relative;
            height: 100vh;
            width: 100vw;
            overflow: auto;
        }

        /* Only active container is visible */
        .container.active {
            display: block;
        }

        /* Optional: fix main-container layout */
        .main-container {
            display: flex;
            height: 100%;
        }
    </style>
</head>
<body>
   <!-- PAGE 1: Welcome -->
 <div id="welcome" class="container active">
    <div class="welcome-message">WELCOME TO <br>BRAINQUEST!</div>
    <input type="text" id="playerName" placeholder="Enter your name">
    <img src="face.png" alt="Face ID" class="face" onclick="openCamera()">
    <button onclick="nextPage('mechanics')" class="start-btn">Start</button>
  </div>

  <!-- Camera Overlay -->
  <div id="camera-overlay">
    <video id="camera" autoplay playsinline></video>
    <button onclick="captureFaceID()">Capture Face ID</button>
    <button onclick="closeCamera()" style="background-color: gray;">Cancel</button>
  </div>

<!-- PAGE 2: Mechanics -->
<div id="mechanics" class="container">
    <h1 class="welcome-message" style="position: absolute; top: -5%;">Mechanics</h1>
    <div class="mechanics">
        <p>Start Your Journey! 🚶‍♂️💨 Begin at the first Stop and follow the adventure.</p>
        <p>Read & Think! 📖🧐 Each Stop has a story—read carefully to understand it!</p>
        <p>Solve & Earn Stars! ⭐✨ Correct answers give you 2 stars!</p>
        <p>Unlock the Next Stop! 🔓🚦 Finish each Stop to move forward.</p>
        <p>Reach the Final Stop! 🏆🔍 Uncover the big mystery!</p>
        <p>Let the adventure begin! 🚀🎉</p>
    </div>
    <button class="start-btn" onclick="nextPage('map'); changeBackgroundForPage3();">Play</button>
</div>

<!-- PAGE 3: Game Map -->
<div id="map" class="container">
    <div class="main-container">
        <!-- Game Map -->
            <div class="map-container">
                <!--Easy house 1-->
                <div class="house" id="house1" onclick="startHouse(1)">
                    <img src="Storyhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="easyhouse1" onclick="startHouse(2)">
                    <img src="easyhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="easyhouse2" onclick="startHouse(3)">
                    <img src="easyhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="easyhouse3" onclick="startHouse(4)">
                    <img src="easyhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="easyhouse4" onclick="startHouse(5)">
                    <img src="easyhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="easyhouse5" onclick="startHouse(6)">
                    <img src="easyhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <!--Easy house 2-->
                <div class="house" id="house2" onclick="startHouse(1)">
                    <img src="Storyhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse1" onclick="startHouse(2)">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse2" onclick="startHouse(3)">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse3" onclick="startHouse(4)">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse4" onclick="startHouse(5)">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse5" onclick="startHouse(6)">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                                <!--Easy house 2-->
                <div class="house" id="house2" onclick="startHouse(1)">
                    <img src="Storyhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse1" onclick="startHouse(2)">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse2" onclick="startHouse(3)">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse3" onclick="startHouse(4)">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse4" onclick="startHouse(5)">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse5" onclick="startHouse(6)">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                 <!--Medium house 1-->
                <div class="house" id="house3" onclick="startHouse(1)">
                <img src="Storyhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="medhouse1" onclick="startHouse(2)">
                <img src="mediumhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="medhouse2" onclick="startHouse(3)">
                <img src="mediumhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="medhouse3" onclick="startHouse(4)">
                <img src="mediumhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 60px; object-fit: cover;">
                </div>
                <div class="house" id="medhouse4" onclick="startHouse(5)">
                <img src="mediumhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="medhouse5" onclick="startHouse(6)">
                <img src="mediumhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div> 
                <!--Medium house 2-->
                <div class="house" id="house4" onclick="startHouse(1)">
                <img src="Storyhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="mediumhouse1" onclick="startHouse(2)">
                <img src="mediumhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="mediumhouse2" onclick="startHouse(3)">
                <img src="mediumhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="mediumhouse3" onclick="startHouse(4)">
                <img src="mediumhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="mediumhouse4" onclick="startHouse(5)">
                <img src="mediumhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="mediumhouse5" onclick="startHouse(6)">
                <img src="mediumhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>    
                    <!--hard house-->
                <div class="house" id="house5" onclick="startHouse(1)">
                <img src="Storyhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="hardhouse1" onclick="startHouse(2)">
                <img src="hardhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="hardhouse2" onclick="startHouse(3)">
                <img src="hardhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="hardhouse3" onclick="startHouse(4)">
                <img src="hardhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="hardhouse4" onclick="startHouse(5)">
                <img src="hardhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="hardhouse5" onclick="startHouse(6)">
                <img src="hardhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>



                <!-- Display Captured Image on Map -->
                <div id="captured-image-wrapper">
                    <img id="captured-image" src="" alt="Your Face ID">
                  </div>
        </div>
    
        <!-- Leaderboard -->
        <div id="leaderboard">
            <h2>Leaderboard</h2>
            <ol id="leaderboard-list">
                <li>Player 1 - 500 pts</li>
                <li>Player 2 - 400 pts</li>
                <li>Player 3 - 300 pts</li>
            </ol>
        </div>
    </div>
</div>

<!-- PAGE 4: Story and Questions -->
<div id="story" class="container">
    <h1 class="welcome-message" style="position: absolute; top: 0%;">Story</h1>
    <div class="story-container">
        <div id="story-content"></div>
        <div id="question-content"></div>
    </div>
</div>

    <script>
function nextPage(pageId) {
    // Hide all containers
    const containers = document.querySelectorAll('.container');
    containers.forEach(container => container.classList.remove('active'));

    // Show selected page
    document.getElementById(pageId).classList.add('active');
}


function changeBackgroundForPage3() {
    document.body.style.background = "white";
}
        let leaderboard = [];

      const video = document.getElementById('camera');
    const cameraOverlay = document.getElementById('camera-overlay');
    let stream;

    // Open camera with white background
    function openCamera() {
      cameraOverlay.style.display = 'flex';
      navigator.mediaDevices.getUserMedia({ video: true })
        .then(mediaStream => {
          stream = mediaStream;
          video.srcObject = stream;
        })
        .catch(error => {
          console.error('Error accessing camera:', error);
          alert('Cannot access camera. Please check permissions.');
          cameraOverlay.style.display = 'none';
        });
    }

    // Close camera and go back to welcome
    function closeCamera() {
      if (stream) {
        stream.getTracks().forEach(track => track.stop());
      }
      cameraOverlay.style.display = 'none';
    }

    // Capture the face image and display on map
    function captureFaceID() {
    const canvas = document.createElement('canvas');
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    const context = canvas.getContext('2d');
    context.drawImage(video, 0, 0, canvas.width, canvas.height);
    const imageData = canvas.toDataURL('image/png');

    console.log("Captured Image Data:", imageData); // For checking the data URL

    // Set captured image to the placeholder
    const capturedImage = document.getElementById('captured-image');
    capturedImage.src = imageData;

    closeCamera(); // Close camera after capture
    // Optionally remove alert and just show image
    // alert("Face ID captured successfully!"); 
    }


        function nextPage(page) {
            document.querySelectorAll('.container').forEach(div => div.classList.remove('active'));
            document.getElementById(page).classList.add('active');
        }

        function startHouse(house) {
    let houseElement = document.getElementById(`house${house}`);

    if (houseElement.classList.contains('locked')) {
        alert('This house is locked!');
        return;
    }

    // Store the current house number
    localStorage.setItem('currentHouse', house);

    // Navigate to the "story" page
    nextPage('story');

    // Display the corresponding story
    displayStory(house);
}

let currentQuestionIndex = 0;
let correctAnswers = 0;

// Story data
let stories = {
    1: `<h2>Elena's Favorite Place</h2>
        <p>Elena loved the forest behind her house. Every afternoon, she walked along the narrow path, enjoying the cool breeze and the fresh scent of pine. The tall trees formed a green roof above her, shading her from the sun. She listened to the rustling leaves and the chirping birds, feeling calm and happy.</p>
        <p>After the rain, the forest looked even more magical. Tiny water droplets sparkled on the leaves, and the small stream flowed faster, carrying twigs downstream. Elena sat on a large tree root, closing her eyes as she listened to the gentle sounds of nature. She always felt peaceful there.</p>
        <p>As the sun began to set, she smiled, knowing she would return again tomorrow to her favorite place.</p>
        <button onclick="startQuestions(1)">Start Questions</button>`,

    2: `<h2>The Secret Garden</h2>
        <p>Elena discovered a hidden garden filled with magical flowers...</p>
        <button onclick="startQuestions(2)">Start Questions</button>`,

    3: `<h2>The Talking River</h2>
        <p>One day, Elena sat by the river and heard whispers from the water...</p>
        <button onclick="startQuestions(3)">Start Questions</button>`,

    4: `<h2>The Lost Treasure</h2>
        <p>Elena stumbled upon an old map that led to an ancient treasure chest...</p>
        <button onclick="startQuestions(4)">Start Questions</button>`
};

// Questions for each story
let questions = {
    1: [
        { q: "Why did Elena enjoy going to the forest every afternoon?", options: ["The tall trees", "The narrow path", "The cool breeze"], correct: 2 },
        { q: "What sound did she enjoy the most?", options: ["Rustling leaves", "Animal noises", "People talking"], correct: 0 },
        { q: "What did Elena sit on in the forest?", options: ["A rock", "A tree root", "A wooden bench"], correct: 1 },
        { q: "When did the forest look magical?", options: ["At sunrise", "After the rain", "During summer"], correct: 1 },
        { q: "How did Elena feel in the forest?", options: ["Bored", "Scared", "Peaceful"], correct: 2 }
    ],
    2: [
        { q: "What did Elena find in the secret garden?", options: ["A hidden door", "Magical flowers", "A golden key"], correct: 1 },
        { q: "Who showed her the way?", options: ["A bird", "A cat", "A butterfly"], correct: 2 },
        { q: "What color were the flowers?", options: ["Blue", "Purple", "Glowing"], correct: 2 },
        { q: "What special thing happened in the garden?", options: ["She met a fairy", "The flowers sang", "A secret door opened"], correct: 1 },
        { q: "How did she feel about the garden?", options: ["Excited", "Scared", "Confused"], correct: 0 }
    ]
};

// Function to display the story
function displayStory(house) {
    let storyContainer = document.getElementById('story-content');
    storyContainer.innerHTML = stories[house] || "<p>No story available.</p>";
}

function startQuestions(house) {
    let storyContainer = document.getElementById('story-content');
    let questionContainer = document.getElementById('question-content');

    currentQuestionIndex = 0;
    correctAnswers = 0;
    
    // Hide the story and show the question section
    storyContainer.style.display = "none";
    questionContainer.style.display = "block";

    askQuestion(house);
}


function askQuestion(house) {
    let questionContainer = document.getElementById('question-content');
    let qData = questions[house];

    if (!qData || qData.length === 0) {
        console.error("❌ Error: No questions found for house", house);
        questionContainer.innerHTML = `<h3>No questions available for this story.</h3>`;
        return;
    }

    if (currentQuestionIndex < qData.length) {
        let question = qData[currentQuestionIndex];

        // Create question and answer buttons dynamically
        let questionHTML = `<h3>${question.q}</h3>`;
        question.options.forEach((option, index) => {
            questionHTML += `<button onclick="checkAnswer(${house}, ${index})">${option}</button>`;
        });

        questionContainer.innerHTML = questionHTML;
        console.log("✅ Displaying question:", question.q);

    } else {
        // Show unlock button after answering all questions
        questionContainer.innerHTML = `<h3>🎉 Congratulations! You completed this story.</h3>
                                       <button onclick="unlockHouse()">Unlock Next House</button>`;
        console.log("🏆 All questions answered for house:", house);
    }
}



// Function to check the selected answer
function checkAnswer(house, selected) {
    let qData = questions[house];
    let correctAnswer = qData[currentQuestionIndex].correct;

    if (selected === correctAnswer) {
        correctAnswers++;
    }

    currentQuestionIndex++;

    // Ask the next question or finish
    askQuestion(house);
}

// Unlock next house only after finishing questions
function unlockHouse() {
    let house = parseInt(localStorage.getItem('currentHouse'));
    let nextHouse = document.getElementById(`house${house + 1}`);

    if (nextHouse && nextHouse.classList.contains('locked')) {
        nextHouse.classList.remove('locked');
        nextHouse.classList.add('unlocked');
        alert(`House ${house + 1} is now unlocked!`);
    } else {
        alert("No more houses to unlock!");
    }
}

        function updateLeaderboard() {
            const playerName = document.getElementById("playerName").value || "Player";

            // Count only answered houses (excluding the locked ones)
            let progress = document.querySelectorAll(".house:not(.locked)").length - 1;

            let existingPlayer = leaderboard.find(player => player.name === playerName);
            if (existingPlayer) {
                existingPlayer.progress = progress;
            } else {
                leaderboard.push({ name: playerName, progress });
            }

            // Sort leaderboard (highest progress first)
            leaderboard.sort((a, b) => b.progress - a.progress);

            // Update leaderboard UI
            const leaderboardList = document.getElementById("leaderboard-list");
            leaderboardList.innerHTML = "";
            leaderboard.forEach(player => {
                let listItem = document.createElement("li");
                listItem.textContent = `${player.name}: ${player.progress} houses`;
                leaderboardList.appendChild(listItem);
            });
        }
      
    </script>
</body>
</html>