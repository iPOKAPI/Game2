<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrainQuest</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            font-family: Arial, sans-serif;
            overflow: hidden;
            background: url(Assets/background.gif) no-repeat center center/cover;
        }
        #story {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: url(Assets/background.gif) no-repeat center center/cover;
        }
       /* Camera Overlay Section */
    #camera-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      background-color: white;
      display: none;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      gap: 20px;
      z-index: 999;
    }

    #camera {
      width: 300px;
      height: 300px;
      border-radius: 50%;
      object-fit: cover;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
    }
    #captured-image-wrapper {
  position: absolute;
  bottom: 60px;
  left: 10px;
  width: 80px; /* Size of the circle */
  height: 80px;
  border: 3px solid white;
  border-radius: 50%; /* Makes it a circle */
  overflow: hidden; /* Hide outside parts */
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
  z-index: 500;
  background: white; /* Optional background for contrast */
}

#captured-image {
  width: 100%;
  height: 100%;
  object-fit: cover; /* Crop to fill the circle */
  object-position: center top; /* Focus on upper part, like face */
}



/* Map section */
#map {
      position: absolute;
      top: 0;
      left: 0;
      width: 1152px; /* Map image width */
      height: 648px; /* Map image height */
      background: url(Assets/map.gif) no-repeat center center;
      background-size: cover;
      transition: transform 0.1s ease-out;
    }

/* Map takes full space */
    .map-container {
      width: 100%;
      height: 100%;
      position: relative;
      cursor: grab;
      overflow: hidden;
    }


/* Houses */
.house {
    width: auto;
    height: auto;
    background: #ffffff00;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
    position: absolute;
    transition: transform 0.2s;
}

.house:hover {
    transform: scale(1.1);
}



/* House positions */
#house1 { bottom: 23%; left: 3%; }
#easyhouse1 { bottom: 22%; left: 11.5%; }
#easyhouse2 { bottom: 22%; left: 22.5%; }
#easyhouse3 { bottom: 15%; left: 32%; }
#easyhouse4 { bottom: 5%; left: 42.5%; }
#easyhouse5 { bottom: 3%; left: 57%; }
#house2 { bottom: 3%; right: 24%; }
#ehouse1 { bottom: 3%; right: 12%; }
#ehouse2 { bottom: 18%; right: 3%; }
#ehouse3 { bottom: 35%; right: 3%; }
#ehouse4 { bottom: 40%; right: 16%; }
#ehouse5 { bottom: 35%; right: 27%; }
#house3 { bottom: 32%; right: 37%; }
#medhouse1 { bottom: 35%; right: 46%; }
#medhouse2 { bottom: 40%; left: 39%; }
#medhouse3 { bottom: 37%; left: 27.5%; }
#medhouse4 { bottom: 40%; left: 17.5%; }
#medhouse5 { bottom: 42%; left: 7%; }
#house4 { top: 30%; left: 2%; }
#mediumhouse1 { top: 14%; left: 8.5%; }
#mediumhouse2 { top: 8%; left: 17%; }
#mediumhouse3 { top: 7%; left: 25%; }
#mediumhouse4 { top: 15%; left: 31.5%; }
#mediumhouse5 { top: 23%; left: 38%; }
#house5 { top: 10%; left: 46.5%; }
#hardhouse1 { top: 8%; right: 38%; }
#hardhouse2 { top: 12%; right: 28%; }
#hardhouse3 { top: 25%; right: 20%; }
#hardhouse4 { top: 16%; right: 10%; }
#hardhouse5 { top: 8%; right: 3%; }


/* Leaderboard styling */
#leaderboard {
      width: 170px;
      height: 100vh;
      position: fixed;
      right: 0;
      top: 0;
      background: rgba(255, 173, 173, 0.95);
      border-left: 2px solid #ccc;
      padding: 20px;
      overflow-y: auto;
      z-index: 15;
}

#leaderboard h2 {
    margin-bottom: 10px;
    color: #c2185b;
}

#leaderboard ol {
    list-style: decimal inside;
    padding: 0;
}

#leaderboard li {
    padding: 8px;
    margin-bottom: 8px;
    background: white;
    border-radius: 4px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

/* Responsive Adjustments */
@media (max-width: 768px) {
    #map {
        width: 100vw;
    }
    #leaderboard {
        display: none; /* Hide leaderboard on small screens */
    }
}

@media (max-width: 480px) {
    .map-container {
        width: 100vw;
        height: 70vh;
        background-size: cover;
    }
}
    button {
      padding: 10px 20px;
      font-size: 14px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      background-color: #007bff;
      color: white;
    }

    button:hover {
      background-color: #0056b3;
    }
                .start-btn {
                    position: absolute;
                    bottom: 15%;
                    right: 5%;
                    background-color: #fc5658;
                    color: white;
                    border: solid 2px black;
                    padding: 10px 20px;
                    font-size: 18px;
                    border-radius: 20px;
                    cursor: pointer;
                    transition: 0.3s;
                }
        
                .start-btn:hover {
                    background-color: darkred;
                }
        input {
            position: absolute;
            padding: 10px;
            font-size: 18px;
            height: 30px;
            border-radius: 20px;
            border: solid 2px black;
            text-align: center;
            outline: none;
            background-color: #efdbb9;
            top: 50%;
            left: 41%;
        }
        .face {
            position: absolute;
            bottom: 10%;
            left: 47%;
            display: block;
            margin: 20px auto;
            width: 100px;
            cursor: pointer;
            border-radius: 50px;
        }
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        @font-face {
            font-family: 'Boorsok';
            src: url(Font/boorsok.otf);
        }
        .welcome-message {
            position: absolute;
            top: 20%;
            left: 50%;
            transform: translate(-50%, -50%);
            align-items: center;
            text-align: center;
            font-size: 150px;
            font-weight: bold;
            line-height: 0.8;
            letter-spacing: 2px;
            font-family: 'Boorsok', sans-serif;
            color: #ffdede;
            text-shadow: 4px 4px 6px rgba(0, 0, 0, 0.3), 0 0 15px #ff69b4, 0 0 30px #ff1493;
            animation: blink 1.5s infinite alternate;
            white-space: nowrap;
        }

        .mechanics {
    position: absolute;
    top: 55%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 18px;
    line-height: 1.8;
    color: #333;
    background: rgba(255, 255, 255, 0.3); /* Soft white with transparency */
    padding: 30px 40px;
    border-radius: 20px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    width: 600px; /* Fixed width */
    max-width: 90%; /* Responsive for small screens */
    backdrop-filter: blur(10px); /* Frosted glass effect */
    text-align: center;
}



.mechanics p {
    margin: 12px 0;
    font-weight: 500;
    color: #333;
}

.mechanics button {
    padding: 12px 35px;
    margin-top: 20px;
    background: linear-gradient(135deg, #ff416c, #ff4b2b);
    color: white;
    border: none;
    border-radius: 50px;
    font-size: 1.2rem;
    cursor: pointer;
    transition: 0.3s ease;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
}

.mechanics button:hover {
    background: linear-gradient(135deg, #ff4b2b, #ff416c);
    transform: scale(1.05);
}

/* Optional: Media query for smaller screens */
@media (max-width: 600px) {
    .mechanics {
        width: 90%; /* Adjust width on small screens */
        padding: 20px;
    }

    .mechanics h1 {
        font-size: 2rem;
    }
}
            .story-container {
                position: absolute;
                top: 60%;
                left: 50%;
                transform: translate(-50%, -50%);
                font-size: 18px;
                line-height: 1.8;
                color: #333;
                background: rgba(255, 255, 255, 0.3); /* Soft white with transparency */
                padding: 20px 30px;
                border-radius: 20px;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
                width: 800px; /* Fixed width */
                max-width: 90%; /* Responsive for small screens */
                backdrop-filter: blur(10px); /* Frosted glass effect */
                text-align: center;
        }


            .story-container p {
                font-size: 18px;
                color: #555;
                line-height: 1.6;
            }

            .story-container button {
                background-color: #ff6f61;
                color: white;
                border: none;
                padding: 10px 20px;
                font-size: 16px;
                cursor: pointer;
                border-radius: 5px;
                margin-top: 20px;
            }

            .story-container button:hover {
                background-color: #e65c50;
            }
           

        /* Media Queries for responsiveness */
        @media (max-width: 768px) {
            .map-container {
                width: 90%;
                height: auto;
            }

            .house {
                width: 40px;
                height: 40px;
                line-height: 40px;
                margin: 5px;
            }

            .start-btn {
                bottom: 10%;
                right: 5%;
                padding: 8px 16px;
                font-size: 16px;
            }
            .welcome-message {
                font-size: 70px;
            }
        
            input {
                width: 80%;
                left: 10%;
                top: 40%;
            }

            .face {
                bottom: 5%;
                left: 40%;
                width: 80px;
            }
        }

        @media (max-width: 480px) {
            .house {
                width: 30px;
                height: 30px;
                line-height: 30px;
                margin: 3px;
            }

            .start-btn {
                bottom: 5%;
                right: 5%;
                padding: 6px 12px;
                font-size: 14px;
            }
            .welcome-message {
                font-size: 90px;
            }
            input {
                width: 90%;
                left: 5%;
                top: 35%;
            }

            .face {
                bottom: 5%;
                left: 35%;
                width: 60px;
            }
        }
        /* By default, hide all containers */
        .container {
            display: none;
            position: relative;
            height: 100vh;
            width: 100vw;
            overflow: auto;
        }

        /* Only active container is visible */
        .container.active {
            display: block;
        }

        /* Optional: fix main-container layout */
        .main-container {
            display: flex;
            height: 100%;
        }
         /* Floating Button */
 .menu-button {
            position: fixed;
            bottom: 10px;
            right: 15px;
            background-color: yellow;
            border: none;
            padding: 15px;
            font-size: 16px;
            border-radius: 50%;
            cursor: pointer;
        }

        /* Popup Menu */
        .popup-menu {
            position: fixed;
            bottom: 60px;
            right: 15px;
            display: none;
            flex-direction: column;
            gap: 10px;
        }

        .popup-menu button {
            padding: 10px;
            background-color: yellow;
            border: none;
            cursor: pointer;
            border-radius: 10px;
            font-size: 16px;
        }
    </style>
</head>
<body>
   <!-- PAGE 1: Welcome -->
 <div id="welcome" class="container active">
    <div class="welcome-message">WELCOME TO <br>BRAINQUEST!</div>
    <input type="text" id="playerName" placeholder="Enter your name">
    <img src="face.png" alt="Face ID" class="face" onclick="openCamera()">
    <button onclick="validateAndProceed()" class="start-btn">Start</button>
  </div>

  <!-- Camera Overlay -->
  <div id="camera-overlay">
    <video id="camera" autoplay playsinline></video>
    <button onclick="captureFaceID()">Capture Face ID</button>
    <button onclick="closeCamera()" style="background-color: gray;">Cancel</button>
  </div>

<!-- PAGE 2: Mechanics -->
<div id="mechanics" class="container">
    <h1 class="welcome-message" style="position: absolute; top: -5%;">Mechanics</h1>
    <div class="mechanics">
        <p>Start Your Journey! 🚶‍♂️💨 Begin at the first Stop and follow the adventure.</p>
        <p>Read & Think! 📖🧐 Each Stop has a story—read carefully to understand it!</p>
        <p>Solve & Earn Stars! ⭐✨ Correct answers give you 2 stars!</p>
        <p>Unlock the Next Stop! 🔓🚦 Finish each Stop to move forward.</p>
        <p>Reach the Final Stop! 🏆🔍 Uncover the big mystery!</p>
        <p>Let the adventure begin! 🚀🎉</p>
    </div>
    <button class="start-btn" onclick="nextPage('map'); changeBackgroundForPage3();">Play</button>
</div>

<!-- PAGE 3: Game Map -->
<div id="map" class="container">
    <div class="main-container">
        <!-- Game Map -->
            <div class="map-container">
                <!--Easy house 1-->
                <div class="house" id="house1" onclick="startStory(1)">
                    <img src="Storyhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house locked" id="easyhouse1" onclick="startHouse(1)">
                    <img src="easyhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="easyhouse2" onclick="startHouse(2)">
                    <img src="easyhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="easyhouse3" onclick="startHouse(3)">
                    <img src="easyhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="easyhouse4" onclick="startHouse(4)">
                    <img src="easyhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="easyhouse5" onclick="startHouse(5)">
                    <img src="easyhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <!--Easy house 2-->
                <div class="house" id="house2" onclick="startStory(2)">
                    <img src="Storyhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse1" onclick="startHouse()">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse2" onclick="startHouse()">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse3" onclick="startHouse()">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse4" onclick="startHouse()">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="ehouse5" onclick="startHouse()">
                    <img src="easyhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                 <!--Medium house 1-->
                <div class="house" id="house3" onclick="startStory(3)">
                <img src="Storyhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="medhouse1" onclick="startHouse(2)">
                <img src="mediumhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="medhouse2" onclick="startHouse(3)">
                <img src="mediumhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="medhouse3" onclick="startHouse(4)">
                <img src="mediumhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 60px; object-fit: cover;">
                </div>
                <div class="house" id="medhouse4" onclick="startHouse(5)">
                <img src="mediumhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="medhouse5" onclick="startHouse(6)">
                <img src="mediumhouse1.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div> 
                <!--Medium house 2-->
                <div class="house" id="house4" onclick="startStory(4)">
                <img src="Storyhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="mediumhouse1" onclick="startHouse(2)">
                <img src="mediumhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="mediumhouse2" onclick="startHouse(3)">
                <img src="mediumhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="mediumhouse3" onclick="startHouse(4)">
                <img src="mediumhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="mediumhouse4" onclick="startHouse(5)">
                <img src="mediumhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="mediumhouse5" onclick="startHouse(6)">
                <img src="mediumhouse2.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>    
                    <!--hard house-->
                <div class="house" id="house5" onclick="startStory(5)">
                <img src="Storyhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="hardhouse1" onclick="startHouse(2)">
                <img src="hardhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="hardhouse2" onclick="startHouse(3)">
                <img src="hardhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="hardhouse3" onclick="startHouse(4)">
                <img src="hardhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="hardhouse4" onclick="startHouse(5)">
                <img src="hardhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>
                <div class="house" id="hardhouse5" onclick="startHouse(6)">
                <img src="hardhouse.png" alt="StoryHouse 1" style="width: 50px; height: 70px; object-fit: cover;">
                </div>



                <!-- Display Captured Image on Map -->
                <div id="captured-image-wrapper">
                    <img id="captured-image" src="" alt="Your Face ID">
                </div>
        </div>
    
        <!-- Leaderboard -->
        <div id="leaderboard">
            <h2>Leaderboard</h2>
            <ol id="leaderboard-list">
                <!-- Player entries will be dynamically arranged here -->
                <li data-points="400">Player 2 - 400 pts</li>
                <li data-points="300">Player 3 - 300 pts</li>
            </ol>
        </div>
        
    </div>
</div>

<!-- PAGE 4: Story and Questions -->
<div id="story" class="container">
    <h1 class="welcome-message" style="position: absolute; top: -5%;">Story</h1>
    <div class="story-container">
        <div id="story-content"></div>
        <div id="question-content"></div>
    </div>
      <!-- Floating Menu Button -->
      <button class="menu-button" onclick="toggleMenu()">☰</button>

      <!-- Popup Menu (Hidden by Default) -->
      <div class="popup-menu" id="popupMenu">
          <button onclick="goHome()">🏠 Home</button>
          <button onclick="goBackToMap()">🗺️ Back to Map</button>
      </div>
</div>

    <script>
function goBackToMap() {
    // Hide all sections/pages first
    document.getElementById('map').style.display = 'block'; // Show map
    document.getElementById('story').style.display = 'none'; // Assuming story page has this ID
    // Hide popup menu if open
    document.getElementById('popupMenu').style.display = 'none';
    document.getElementById('leaderboard').style.display = 'block';
    document.getElementById('captured-image').style.display = 'block';

}
         function toggleMenu() {
            let menu = document.getElementById("popupMenu");
            menu.style.display = (menu.style.display === "flex") ? "none" : "flex";
        }


        let playerNameGlobal = "";
        let leaderboard = [];

        function validateAndProceed() {
    const playerNameInput = document.getElementById('playerName');
    const playerName = playerNameInput.value.trim();

    if (playerName === "") {
        alert("Please enter your name to proceed.");
        return;
    }

    playerNameGlobal = playerName;

    // Check if player already exists
    let existingPlayer = leaderboard.find(player => player.name === playerName);
    if (!existingPlayer) {
        leaderboard.push({ name: playerName, points: 0 }); // Initialize at 0 pts
    }

    updateLeaderboardUI(); // Show leaderboard
    nextPage('mechanics'); // Proceed to next screen
}

function addPointsForCorrectAnswer() {
    let player = leaderboard.find(p => p.name === playerNameGlobal);
    if (player) {
        player.points += 2; // Add 2 points per correct answer
    } else {
        leaderboard.push({ name: playerNameGlobal, points: 2 }); // If somehow not added, add now
    }

    // Sort leaderboard by points descending
    leaderboard.sort((a, b) => b.points - a.points);

    // Update UI
    updateLeaderboardUI();
}


function nextPage(pageId) {
    // Hide all containers
    const containers = document.querySelectorAll('.container');
    containers.forEach(container => container.classList.remove('active'));

    // Show selected page
    document.getElementById(pageId).classList.add('active');
}

function sortLeaderboard() {
    const leaderboardList = document.getElementById('leaderboard-list');
    const players = Array.from(leaderboardList.querySelectorAll('li'));

    // Sort descending by data-points
    players.sort((a, b) => parseInt(b.dataset.points) - parseInt(a.dataset.points));

    // Append sorted elements back to list
    leaderboardList.innerHTML = '';
    players.forEach(player => leaderboardList.appendChild(player));
}

function updateLeaderboardUI() {
    const leaderboardList = document.getElementById('leaderboard-list');
    leaderboardList.innerHTML = ''; // Clear current list

    leaderboard.forEach(player => {
        const listItem = document.createElement('li');
        listItem.textContent = `${player.name} - ${player.points} pts`;
        leaderboardList.appendChild(listItem);
    });
}



function changeBackgroundForPage3() {
    document.body.style.background = "white";
}
    

    const video = document.getElementById('camera');
    const cameraOverlay = document.getElementById('camera-overlay');
    let stream;

    // Open camera with white background
    function openCamera() {
      cameraOverlay.style.display = 'flex';
      navigator.mediaDevices.getUserMedia({ video: true })
        .then(mediaStream => {
          stream = mediaStream;
          video.srcObject = stream;
        })
        .catch(error => {
          console.error('Error accessing camera:', error);
          alert('Cannot access camera. Please check permissions.');
          cameraOverlay.style.display = 'none';
        });
    }

    // Close camera and go back to welcome
    function closeCamera() {
      if (stream) {
        stream.getTracks().forEach(track => track.stop());
      }
      cameraOverlay.style.display = 'none';
    }

    // Capture the face image and display on map
    function captureFaceID() {
    const canvas = document.createElement('canvas');
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;
    const context = canvas.getContext('2d');
    context.drawImage(video, 0, 0, canvas.width, canvas.height);
    const imageData = canvas.toDataURL('image/png');

    console.log("Captured Image Data:", imageData); // For checking the data URL

    // Set captured image to the placeholder
    const capturedImage = document.getElementById('captured-image');
    capturedImage.src = imageData;

    closeCamera(); // Close camera after capture
    // Optionally remove alert and just show image
    // alert("Face ID captured successfully!"); 
    }


        function nextPage(page) {
            document.querySelectorAll('.container').forEach(div => div.classList.remove('active'));
            document.getElementById(page).classList.add('active');
        }


    let currentQuestionIndex = 0;
    let unlockedHouses = 1;
    let questions = []; // This will hold current story's questions

    function startStory(storyNumber) {
    if (storyNumber > unlockedHouses) {
        alert('This house is locked! Complete the previous house first.');
        return;
    }
    currentStory = storyNumber;
    currentQuestionIndex = 0;

    // Show the entire story container (PAGE 4)
    document.getElementById('story').style.display = 'block';

    // Inject story content inside the designated container
    document.getElementById('story-content').innerHTML = stories[storyNumber];
    document.getElementById('story-content').style.display = 'block';

    // Hide question content initially
    document.getElementById('question-content').style.display = 'none';
        // Hide other components like captured image and leaderboard
        document.getElementById('captured-image-wrapper').style.display = 'none';
    document.getElementById('leaderboard').style.display = 'none';
}


    function startHouse(house) {
        let houseElement = document.getElementById(`house${house}`);
        if (houseElement.classList.contains('locked')) {
            alert('This house is locked! Answer more questions to unlock it.');
        } else {
            alert(`Welcome to House ${house}!`);
        }
    }
    let currentStoryIndex = 1; // Initial story

    function startQuestions(storyIndex) {
    currentStoryIndex = storyIndex;
    currentQuestionIndex = 0;
    questions = AllQuestions[storyIndex]; // Load questions for this story
    askQuestion(); // Start asking questions
}


function askQuestion() {

    let qContainer = document.getElementById('question-content');
    qContainer.style.display = 'block'; // <-- Make it visible!
    document.getElementById('story-content').style.display = 'none';
    let qData = questions[currentQuestionIndex];
    let optionsHtml = qData.options.map((opt, index) => `
        <button onclick="checkAnswer(${index})">${opt}</button>
    `).join('');

    qContainer.innerHTML = `
        <p>${qData.q}</p>
        ${optionsHtml}
    `;
}



function checkAnswer(selectedIndex) {
    let correctAnswer = questions[currentQuestionIndex].correct;

    if (selectedIndex === correctAnswer) {
        alert('Correct! +2 points awarded.');
        addPoints(2); // Award points
    } else {
        alert('Wrong answer!');
    }

    currentQuestionIndex++;
    askQuestion(); // Load next question or move to the next story
}
function loadStory(storyIndex) {
    let storyContainer = document.getElementById('story-content');
    storyContainer.innerHTML = stories[storyIndex];
}
function addPoints(points) {
    let player = leaderboard.find(p => p.name === playerNameGlobal);
    if (player) {
        player.points += points; // Add points
    } else {
        leaderboard.push({ name: playerNameGlobal, points: points }); // If somehow missing
    }

    leaderboard.sort((a, b) => b.points - a.points); // Sort leaderboard
    updateLeaderboardUI(); // Refresh display
}


    function unlockNextHouse() {
        unlockedHouses++;
        let houseToUnlock = document.getElementById(`house${unlockedHouses}`);
        if (houseToUnlock) {
            houseToUnlock.classList.remove('locked');
            houseToUnlock.classList.add('unlocked');
            alert(`House ${unlockedHouses} is now unlocked!`);
        }
    }

// Story data
let stories = {
    1: `<h2>Elena's Favorite Place</h2>
        <p>Elena loved the forest behind her house. Every afternoon, she walked along the narrow path, enjoying the cool breeze and the fresh scent of pine. The tall trees formed a green roof above her, shading her from the sun. She listened to the rustling leaves and the chirping birds, feeling calm and happy.</p>
        <p>After the rain, the forest looked even more magical. Tiny water droplets sparkled on the leaves, and the small stream flowed faster, carrying twigs downstream. Elena sat on a large tree root, closing her eyes as she listened to the gentle sounds of nature. She always felt peaceful there.</p>
        <p>As the sun began to set, she smiled, knowing she would return again tomorrow to her favorite place.</p>
        <button onclick="startQuestions(1)">Start Questions</button>`,

    2: `<h2>The Brave Little Squirrel</h2>
        <p>Once upon a time, in a lush, green forest, there lived a little squirrel named Sammy. Sammy wasn’t the biggest or the fastest squirrel, but he had something special—courage. One bright morning, a terrible storm cloud appeared, darkening the sky and sending a chilly wind across the forest. All the animals scurried to their homes, afraid of the heavy rain and loud thunder.</p>
        <p>But Sammy, instead of hiding like the others, decided to face the storm. "I may be small," he said to himself, "but I’m brave enough to help!" Sammy ran to the tallest oak tree, where a family of birds had made their nest. The wind was blowing so hard that the nest was shaking, and the baby birds were in danger of falling.</p>
        <p>Without thinking twice, Sammy climbed the tree, holding onto the branches like a rock climber gripping the cliffside. He carefully gathered the baby birds, one by one, and carried them safely to a lower, stronger branch. As the storm raged on, Sammy kept watch over the little birds, making sure they were safe.</p>
        <p>When the storm finally passed and the sun came out, the other animals came out of their shelters. They looked at Sammy with wide eyes. "How did you do it?" asked a curious rabbit. Sammy smiled and replied, "It’s not about being the biggest or the fastest; it’s about having the courage to do what’s right, even when it’s hard."</p>
        <p>From that day on, Sammy became a hero in the forest. All the animals learned that bravery isn't about size or strength—it's about having the heart to help others, no matter the challenge.</p>
        <button onclick="startQuestions(2)">Start Questions</button>`,

    3: `<h2>The Mysterious Stranger</h2>
        <p>One cold, windy evening in the quiet village of Ravenswood, 12-year-old Emma spotted a mysterious person walking down the cobblestone road. The stranger wore a long cloak and carried a glowing lantern, which made Emma very curious since visitors hardly ever came to her village. She decided to follow them and watched as they entered the spooky, abandoned inn at the edge of town. Gathering all her courage, Emma peeked inside and saw the stranger looking at an old map. When they noticed her, the stranger introduced themselves as Elias and explained they were searching for something special—a magical gem called the Starstone that had been lost long ago.</p>
        <p>Excited to be part of an adventure, Emma offered to help. Together, they searched every corner of the dusty inn until Emma spotted a strange stone in the fireplace with odd markings on it. With Elias’s help, they pulled the stone loose and found a hidden compartment holding a glowing blue gem—the Starstone! Elias smiled and thanked Emma for being so brave and clever. They promised to keep the gem safe from harm and gave her a shiny silver coin as a gift to remember their adventure. As the sun rose over Ravenswood, Elias disappeared down the road, leaving Emma with a wonderful story to tell and the memory of an exciting night she would never forget.</p>
        <button onclick="startQuestions(3)">Start Questions</button>`,

    4: `<h2>The Mystery of the Missing Trophy</h2>
        <p>The annual school quiz bee had just ended, and Mr. Cruz proudly held up the gleaming gold trophy. "This will stay in the display case for everyone to see," he announced. The students cheered, especially Ben, Mia, and Carlo, who were the top three finalists. After the event, the three students stayed behind for different reasons. Ben returned to the room to get his forgotten notebook, Mia searched for her lost bracelet, and Carlo was tasked with cleaning up the quiz materials. Everything seemed normal until the next morning when the principal discovered that the trophy was missing. With no signs of a break-in, suspicion fell on the last three students seen near the display case. The principal called them to her office to help solve the mystery.</p>
        <p>During the investigation, strange clues began to surface. Mia noticed a smear of shiny gold paint on a desk near the door. Carlo remembered hearing a loud clink as he left the room, but he didn’t think much of it at the time. Meanwhile, Ben, known for being forgetful, couldn’t recall if he locked the door after retrieving his notebook. The principal carefully questioned each student, trying to piece together the truth. Who could have taken the trophy, and why? With the clock ticking, it was up to the principal to use the clues and find the missing prize before the school day ended.</p>
        <button onclick="startQuestions(4)">Start Questions</button>`,

    5: `<h2>The Broken Bracelet</h2>
        <p>Ella and Mia had been best friends since first grade. They did everything together eating lunch, working on projects, and playing after school. One day, Ella gave Mia a beautiful friendship bracelet with their initials on it. "This means we'll always be friends," Ella said with a smile. Mia promised to wear it every day. But a week later, during recess, Ella noticed Mia wasn’t wearing the bracelet. When she asked about it, Mia looked nervous and said, "I lost it... I’m really sorry." Ella felt hurt and wondered if their friendship still mattered to Mia.</p>
        <p>The next day, Ella stopped talking to Mia, thinking her friend didn’t care anymore. Mia felt sad but didn’t know how to fix things. After school, while cleaning her backpack, Mia found the bracelet tucked inside a hidden pocket. She ran to Ella’s house and held it up. "I found it! I never stopped caring—I was just scared you'd be mad," Mia said. Ella smiled and hugged her. "I’m sorry for getting upset. Our friendship is more important than a bracelet," she said. From that day on, they learned that honest communication and understanding could make their friendship even stronger.</p>
        <button onclick="startQuestions(5)">Start Questions</button>`
};

let AllQuestions = {
    1: [ // Elena's Favorite Place
        { q: "Where did Elena like to go every afternoon?", options: ["The park", "The forest", "The river"], correct: 1 },
        { q: "What formed a green roof above her?", options: ["Tall trees", "Clouds", "Mountains"], correct: 0 },
        { q: "What did Elena sit on in the forest?", options: ["A rock", "A tree root", "A bench"], correct: 1 },
        { q: "When did the forest look magical to Elena?", options: ["After the rain", "At night", "In the morning"], correct: 0 },
        { q: "How did Elena feel in the forest?", options: ["Lonely", "Peaceful", "Scared"], correct: 1 }
    ],
    2: [ // The Brave Little Squirrel
        { q: "What was the little squirrel's name?", options: ["Sammy", "Benny", "Tommy"], correct: 0 },
        { q: "Why were the baby birds in danger?", options: ["They were hungry", "The nest was shaking in the storm", "A fox was nearby"], correct: 1 },
        { q: "What did Sammy do to help the birds?", options: ["Fed them", "Carried them to a safer branch", "Built a new nest"], correct: 1 },
        { q: "What made Sammy special?", options: ["He was the fastest", "He was very brave", "He could fly"], correct: 1 },
        { q: "What did the other animals think of Sammy after the storm?", options: ["They ignored him", "He became a hero", "They laughed at him"], correct: 1 }
    ],
    3: [ // The Mysterious Stranger
        { q: "Who was the mysterious person Emma followed?", options: ["Elias", "Ethan", "Edward"], correct: 0 },
        { q: "What was the stranger carrying?", options: ["A glowing lantern", "A sword", "A book"], correct: 0 },
        { q: "What magical item were they searching for?", options: ["A golden ring", "A silver sword", "The Starstone"], correct: 2 },
        { q: "Where did they find the Starstone?", options: ["Under a table", "In the fireplace", "Behind a door"], correct: 1 },
        { q: "What did Elias give Emma as a gift?", options: ["A necklace", "A silver coin", "A magic wand"], correct: 1 }
    ],
    4: [ // The Mystery of the Missing Trophy
        { q: "Who discovered the trophy was missing?", options: ["The teacher", "The principal", "The janitor"], correct: 1 },
        { q: "Who were the last three students seen near the trophy?", options: ["Ben, Mia, Carlo", "Ben, Anna, Carlo", "Mia, Carlo, Sam"], correct: 0 },
        { q: "What clue did Mia find?", options: ["A broken window", "Gold paint on a desk", "A note"], correct: 1 },
        { q: "What did Carlo hear as he left the room?", options: ["Footsteps", "A loud clink", "Voices"], correct: 1 },
        { q: "Why was Ben suspicious?", options: ["He was always near the trophy", "He forgot if he locked the door", "He saw someone take it"], correct: 1 }
    ],
    5: [ // The Broken Bracelet
        { q: "What did Ella give Mia?", options: ["A necklace", "A friendship bracelet", "A book"], correct: 1 },
        { q: "Why was Ella upset with Mia?", options: ["Mia lost the bracelet", "Mia didn’t talk to her", "Mia broke her toy"], correct: 0 },
        { q: "Where did Mia find the bracelet?", options: ["In her backpack", "Under her bed", "At school"], correct: 0 },
        { q: "What did Mia do after finding the bracelet?", options: ["Kept it", "Returned it to Ella", "Threw it away"], correct: 1 },
        { q: "What did they learn about friendship?", options: ["It's about gifts", "It needs trust and communication", "It's only for fun"], correct: 1 }
    ]
};


function setPlayerName() {
    const nameInput = document.getElementById("playerName");
    playerNameGlobal = nameInput.value.trim() || "Player";
}
  
    </script>
</body>
</html>